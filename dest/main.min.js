"use strict";function loadMessages(){var t=window.location.search,a=t.substr(1,t.indexOf("&")-1),e=t.substr(t.indexOf("&")+1);e=e.substr(e.indexOf("=")+1),$(".chat__header").html(e),$.ajax({url:"/php/getmessages.php",data:a,method:"POST",success:function(t){var a=JSON.parse(t);$(".chat__inner").html("");for(var e=0;e<a.length;e++){var n="<p class=\"par\"><span class='chat__name'>"+a[e].name+" "+a[e].surname+"</span>  "+a[e].message_date+"<br>"+a[e].body+"</p>";$(".chat__inner").append(n)}$(".chat__inner").append("<div id='down'></div>"),$(".test").click()},error:function(t){console.log("Error")}})}function checkChatStatus(){var t=window.location.search,a=t.substr(1,t.indexOf("&")-1);$.ajax({url:"/php/getlastmessage.php",data:a,method:"POST",success:function(t){"unread"==t&&loadMessages()},error:function(t){console.log("Error")}})}$(document).ready(function(){function t(t){for(var a={},e=$(t).serializeArray(),n=0;n<e.length;n++)a[e[n].name]=e[n].value;return a}$(".top-button").on("click",function(){$("html, body").animate({scrollTop:$("#top").offset().top},700)}),$(".tablinks").on("click",function(t){t.preventDefault();for(var a=document.getElementsByClassName("tablinks"),e=document.getElementsByClassName("tabcontent"),n=0;n<a.length;n++)$(a[n]).removeClass("active"),$(e[n]).css("display","none");var s=t.currentTarget;$(s).addClass("active");var r=$(s).attr("href").substring(1);$("#"+r).css("display","block")}),$(".news__button").on("click",function(t){$(this).hide(),$(".news__form").show()}),$(".news__form").on("submit",function(a){var e=$(this).serialize();return console.log(e),$.ajax({url:"/php/regnews.php",data:e,method:"POST",success:function(e){var n="<p class='par'><span class='news__date'>"+e+"</span><br>"+t(a.currentTarget).text+"</p><br>";$(".news__block").prepend(n)},error:function(t){console.log("Error")}}),$(this).hide(),$(".news__button").show(),!1}),$(".chat__button").on("click",function(t){$(this).hide(),$(".chat__form").show()}),$(".chat-write__form").on("submit",function(a){var e=t(a.currentTarget);return $.ajax({url:"/php/setmessages.php",data:e,method:"POST",success:function(t){$("textarea").val(""),$("textarea").text(""),loadMessages()},error:function(t){console.log("Error")}}),!1}),$(".chat__add").on("click",function(t){t.preventDefault(),$.ajax({url:"../php/getallfriends.php",method:"POST",data:{},success:function(t){var a=JSON.parse(t),e=window.location.search,n=e.substr(1,e.indexOf("&")-1);n=n.substr(n.indexOf("=")+1),$.ajax({url:"../php/getparticipants.php",method:"POST",data:{chatroom_id:n},success:function(t){for(var e=JSON.parse(t),s=0;s<a.length;s++)for(var r=0;r<e.length;r++)if(e[r].id==a[s].id){a.splice(s,1);break}$(".chat-add__list").html("");for(s=0;s<a.length;s++){var o="<li class='chat-add__item'>"+a[s].name+" "+a[s].surname+" <a href='/php/addchatroom.php?chatroom_id="+n+"&friend_id="+a[s].id+"' class='link chat-add__link'>+</a></li>";$(".chat-add__list").append(o)}$(".chat-add__list").html()||$(".chat-add__list").html("Нет данных для отображения"),$(".chat-add").modal()},error:function(t){console.log(t)}})},error:function(t){console.log(t)}})}),$(".chat-add__list").on("click",".chat-add__link",function(t){t.preventDefault();var a=$(this).attr("href"),e=a.substr(0,a.indexOf("?")),n=a.substr(a.indexOf("&")+1),s=a.substr(a.indexOf("?")+1,a.indexOf("&")),r={};r[(s=s.substr(0,s.indexOf("&"))).substr(0,s.indexOf("="))]=s.substr(s.indexOf("=")+1),r[n.substr(0,n.indexOf("="))]=n.substr(n.indexOf("=")+1);var o=this;$.ajax({url:e,method:"GET",data:r,success:function(t){$(".chat-add__list").find(o).parent().remove(),$(".chat-add__list").html()||$(".chat-add__list").html("Нет данных для отображения")},error:function(t){console.log(t)}})}),$(".chat__participants").on("click",function(t){t.preventDefault(),$(".chat-part").modal();var a=window.location.search,e=a.substr(1,a.indexOf("&")-1);e=e.substr(e.indexOf("=")+1),$.ajax({url:"../php/getparticipants.php",method:"POST",data:{chatroom_id:e},success:function(t){var a=JSON.parse(t);$(".chat-part__list").html("");for(var e=0;e<a.length;e++){var n="<li class='chat-part__item'>"+a[e].name+" "+a[e].surname+"</li>";$(".chat-part__list").append(n)}},error:function(t){console.log(t)}})}),$(".news__delete").on("click",function(t){return!!confirm("Are you sure to delete the news?")})});